# Demo
The demo portion of this repository follows the steps laid out in create_chips.py and keras_obj_det.py. First, create_chips.py walks through the steps of creating training chips for an object detection model. Next, keras_obj_det.py goes through the process of ingesting and processing the training data, training a model and testing the model on a small image containing ships for detection. 
#
### create_chips.py
The images found in image_chips_60m.zip, and image_chips_60m_2.zip are produced from a manaul process in QGIS of locating ships in the desired image AOI, creating a square buffer around centroid points, and clipping the satellite image to each buffer region. This in turn creates a 60m x 60m image chip of a ship. The images in image_chips_60m_random.zip are produced following similar steps. However, instead of labeling known ships, random points are generated across the AOI to create negative training samples. The images in image_chips_60m_water are negative samples of water areas. These images significantly improve the models ability to predict open water vessels. The code in create_chips.py ingests these images, crops them to the desired dimension, and transforms/replicates the positive images to create additional training data. 
#
### keras_obj_det.py
Next, keras_obj_det.py ingests the previously created training chips, as well as supplementary training which can be found at
https://www.kaggle.com/rhammell/ships-in-satellite-imagery
These training datasets are combined and trained on a simple keras sequential model. Next, a test image containing ships and masked to not include non-water areas is imported to test object detecting capability. A function is defined to create a moving window that traverses through the image and makes predictions using the previously trained model. Where multiple predictions are made for the same object, the inersection over union (IOU) is calculated and the prediction with the highest score is kept. The results can be visualized on the imported image. Additionally, the results are formatted to a Well Known Text (WKT) string. This can be used in importing into GIS software by re-attributing the geographic values of the image to the output bounding boxes.
#
### keras_obj_det_w/segmentation.py
This is an extension to the modeling done in keras_obj_det.py but rather than programming a "moving window" to traverse through an image and make predictions on millions of images, this code utilizes K-Means Clustering to segment the image. After running a K-Means Clustering algorithm on the feature image, the coordinate locations of the minority class in the image are collected and testing images are produced to run predictions on. This decreases the number of predictions that need to be made by the model by over 1000% thus significantly improving run time and computing.
